{
  "meta": {
    "org_name": "ExampleCorp",
    "timezone": "America/Toronto",
    "description": "Contexte enrichi pour triage SOC. Intègre rôles Linux, seuils de récurrence et logique de vérification contextuelle."
  },

  "business_hours": {
    "weekdays": {
      "mon": [["08:30:00", "18:30:00"]],
      "tue": [["08:30:00", "18:30:00"]],
      "wed": [["08:30:00", "18:30:00"]],
      "thu": [["08:30:00", "18:30:00"]],
      "fri": [["08:30:00", "17:30:00"]]
    },
    "holidays": ["2025-12-25", "2025-12-26"]
  },

  "network": {
    "office_cidrs": ["192.168.1.0/24", "10.10.0.0/16"],
    "trusted_remote_vpn": ["203.0.113.0/28"],
    "external_allowlist": ["8.8.8.8/32"]
  },

  "groups": {
    "IT":        { "members": ["it_admin", "helpdesk01", "ops_lead", "env-admin", "root"], "can_remote": true,  "allowed_out_of_hours": true,  "allowed_from_external": true,  "notes": "Opérations/Support"},
    "ADMINS":    { "members": ["sec_lead", "cto"] ,                                        "can_remote": true,  "allowed_out_of_hours": true,  "allowed_from_external": true,  "notes": "Administrateurs sécurité/exec" },
    "FINANCE":   { "members": ["acct_1", "acct_manager", "ARTUser", "art"],                "can_remote": false, "allowed_out_of_hours": false, "allowed_from_external": false, "notes": "Comptabilité"  },
    "HR":        { "members": ["hr_1", "hr_manager"],                                      "can_remote": false, "allowed_out_of_hours": false, "allowed_from_external": false, "notes": "Ressources humaines"  },
    "SERVICE_ACCOUNTS": { "members": ["SYSTEM", "LOCAL SERVICE", "NETWORK SERVICE", "svc_backup"] , "is_technical": true, "can_remote": false, "allowed_out_of_hours": true, "allowed_from_external": false, "notes": "Identités techniques/non humaines" }
  },

  "users": {
    "it_admin":    { "groups": ["IT", "ADMINS"], "roles": ["sysadmin"] },
    "helpdesk01":  { "groups": ["IT"], "roles": ["support"] },
    "ops_lead":    { "groups": ["IT"], "roles": ["operations"] },
    "env-admin":   { "groups": ["IT"], "roles": ["linux_admin","windows_admin"] },
    "root":        { "groups": ["IT"], "roles": ["root_admin"] },
    "sec_lead":    { "groups": ["ADMINS"], "roles": ["security_admin"] },
    "cto":         { "groups": ["ADMINS"], "roles": ["exec"] },
    "acct_1":      { "groups": ["FINANCE"], "roles": ["accountant"] },
    "acct_manager":{ "groups": ["FINANCE"], "roles": ["finance_manager"] },
    "ARTUser":     { "groups": ["FINANCE"], "roles": ["finance_analyst"] },
    "art":         { "groups": ["FINANCE"], "roles": ["finance_support"] },
    "hr_1":        { "groups": ["HR"], "roles": ["hr_associate"] },
    "hr_manager":  { "groups": ["HR"], "roles": ["hr_manager"] },
    "SYSTEM":      { "groups": ["SERVICE_ACCOUNTS"], "roles": ["system"] },
    "LOCAL SERVICE":   { "groups": ["SERVICE_ACCOUNTS"], "roles": ["system"] },
    "NETWORK SERVICE": { "groups": ["SERVICE_ACCOUNTS"], "roles": ["system"] },
    "svc_backup":      { "groups": ["SERVICE_ACCOUNTS"], "roles": ["backup_service"] }
  },

  "assets": {
    "localhost.localdomain": { "role": "linux_workstation", "site": "HQ", "owner_group": "IT", "tags": ["linux", "pam"] },
    "DESKTOP-MDNNEJF":       { "role": "windows_workstation", "site": "HQ", "owner_group": "IT", "tags": ["windows", "workgroup"] },
    "SRV-DB-01":             { "role": "server", "site": "HQ", "owner_group": "FINANCE", "tags": ["windows", "db"] }
  },

  "role_catalog": {
    "linux_workstation": {
      "expected_technical_accounts": ["root", "env-admin"],
      "expected_service_processes": ["/usr/sbin/cron", "/usr/sbin/chpasswd"],
      "typical_logon_types": [0, 1]
    },
    "windows_workstation": {
      "expected_technical_accounts": ["SYSTEM", "LOCAL SERVICE", "NETWORK SERVICE"],
      "expected_service_processes": ["C:\\\\Windows\\\\System32\\\\services.exe", "C:\\\\Windows\\\\System32\\\\svchost.exe"],
      "typical_logon_types": [2, 3, 5]
    },
    "server": {
      "expected_technical_accounts": ["SYSTEM", "svc_backup", "root"],
      "expected_service_processes": ["C:\\\\Windows\\\\System32\\\\services.exe", "/usr/sbin/sshd"],
      "typical_logon_types": [3, 5]
    }
  },

  "geo": {
    "allowed_countries": ["CA", "US"]
  },

  "maintenance_windows": [
    { "start": "2025-10-20T22:00:00-04:00", "end": "2025-10-21T02:00:00-04:00", "note": "Nightly patching" }
  ],

  "policies": {
    "recurrent_events": {
      "description": "Politique générique de détection d'événements répétés (auth, accès, process, etc.).",
      "enabled": true,

      "threshold": 4,
      "window_minutes": 5,

      "group_by": ["user", "host", "event_type"],
      "ignore_accounts": ["SYSTEM", "LOCAL SERVICE", "NETWORK SERVICE", "svc_backup"],
      "count_service_accounts": false,
      "reset_on_success": true,

      "default_single_event_policy": "not-interesting",

      "decision_logic": [
        "Étape 1: Évaluer le contexte (utilisateur connu/droit, plage horaire, site/IP, pays, rôle de l’actif).",
        "Étape 2: Si une règle critique est violée (utilisateur inconnu, IP hors office/vpn/allowlist, pays interdit), classer 'interesting' immédiatement.",
        "Étape 3: Sinon, un seul événement isolé reste 'not-interesting' par défaut.",
        "Étape 4: Si le même event_type se répète >= threshold dans window_minutes pour la même clé (user+host+event_type), classer 'interesting'."
      ]
    },

    "event_type_hints": {
      "description": "Aides génériques pour dériver event_type sans dépendre d’une plateforme.",
      "rules": [
        { "match": {"rule.groups": "authentication_failed"}, "event_type": "authentication_failed" },
        { "match": {"win.system.eventID": [4625]},           "event_type": "authentication_failed" },
        { "match": {"rule.description": "login failed"},     "event_type": "authentication_failed" },
        { "match": {"rule.description": "authentication failure"}, "event_type": "authentication_failed" }
      ]
    }
  },

"policies": {
  "auth_failures": {
    "description": "Politique de triage des échecs d'authentification avec seuils de récurrence et exceptions contextuelles.",
    "recurrence": { "threshold": 4, "window": "5min" }
    },
    "notes": "Un seul échec d'authentification = not-interesting. Devient interesting si >= threshold dans window OU si exception."
},

  "facts": {
    "password_change": {
      "sensitive": true,
      "typically_initiated_by": ["user_self_service", "it_admin"],
      "requires_verification_for_groups": ["FINANCE", "HR"]
    },
    "sudo_actions": {
      "critical_roles": ["root", "env-admin"],
      "review_required_for": ["FINANCE", "HR", "GUEST"]
    }
  }
}
